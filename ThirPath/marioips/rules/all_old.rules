drop tcp any any -> any $HTTP_PORTS (msg:"Weblogic _async RCE(CVE-2019-2725)"; flow: established, to_server; flowbits:set,10000002; content: "POST"; nocase; http_method; content: "wls-wsat"; http_uri; pcre:"/(oracle\.toplink\.internal\.sessions\.UnitOfWorkChangeSet|org\.slf4j\.ext\.EventData|com\.sun\.rowset\.JdbcRowSetImpl)/iP"; content: "<class>";reference: cve, 2019-2725; classtype:web-application-attack;sid: 10000002; rev: 2;)
drop tcp any any -> any $HTTP_PORTS (msg:"Weblogic _async RCE(CVE-2019-2725)"; flow: established, to_server; flowbits:set,10000002; content: "POST"; nocase; http_method; content: "async"; http_uri; pcre: "/(oracle\.toplink\.internal\.sessions\.UnitOfWorkChangeSet|org\.slf4j\.ext\.EventData)/iP"; content: "<class>";reference: cve, 2019-2725; classtype:web-application-attack;sid: 10000003; rev: 2;)
drop tcp any $HTTP_PORTS -> any any (msg:"Weblogic _async RCE(CVE-2019-2725)"; flowbits:isset,10000002; content: "200"; http_stat_code; reference: cve, 2019-2725; classtype:web-application-attack;sid: 10000004; rev: 2;)
drop tcp any any -> any $HTTP_PORTS (msg:"Weblogic wls-wsat RCE (CVE-2019-2729)"; flow: established, to_server; content: "POST"; nocase; http_method; content: "wls-wsat"; http_uri; pcre: "/(oracle\.toplink\.internal\.sessions\.UnitOfWorkChangeSet|org\.slf4j\.ext\.EventData)/iP"; pcre: "/<array method=.+>/iP";reference: cve, 2019-2729;classtype:web-application-attack;sid: 10000005; rev: 1;)
drop tcp any any -> any $HTTP_PORTS (msg:"Weblogic wls-wsat RCE (CVE-2019-2729)"; flow: established, to_server; content: "POST"; nocase; http_method; content: "async"; http_uri; pcre: "/(oracle\.toplink\.internal\.sessions\.UnitOfWorkChangeSet|org\.slf4j\.ext\.EventData)/iP"; pcre: "/<array method=.+>/iP";reference: cve, 2019-2729;classtype:web-application-attack;sid: 10000006; rev: 1;)
drop tcp any any -> any $HTTP_PORTS (msg:"IPTV Smarters WEB TV PLAYER File Upload (CVE-2020-9380)"; content:"POST"; http_method; content:"/includes/ajax-control.php"; http_uri; content:"logoImage"; http_client_body; pcre:"/filename=\".+\.php\"/iP"; classtype:web-application-attack; reference:cve,2020-9380; sid:10000007; rev:1;)
drop udp any any -> any 53 (msg:"bs.unaout.com request"; flow:to_server; content:"|02|bs|06|unaout|03|com"; nocase; offset:12; depth:14; classtype:trojan-activity; sid:10000008; rev:1;)
drop udp any any -> any 53 (msg:"junfac.com request"; flow:to_server; content:"|06|junfac|03|com"; nocase; classtype:trojan-activity; sid:10000009; rev:1;)
drop tcp any any -> any $HTTP_PORTS (msg: "Weblogic RCE (CVE-2019-2618)"; flow: established, to_server; flowbits:set,30000007;content: "POST"; nocase; http_method; content: "/bea_wls_deployment_internal/DeploymentService"; http_uri; content: "app_upload"; http_header; content: "_WL_internal"; http_header; content: "bea_wls_"; http_header; distance: 0; reference: cve, 2019-2618; reference: url, github.com/jas502n/cve-2019-2618/blob/master/cve-2019-2618.py; reference: url, github.com/ptresearch/AttackDetection; classtype:web-application-attack; sid: 30000007; rev: 1;)
drop tcp any $HTTP_PORTS -> any any (msg: "Weblogic RCE (CVE-2019-2618) resp"; flow: established, to_client; flowbits:isset,30000007;content: "200"; http_stat_code; reference: cve, 2019-2618; reference: url, github.com/jas502n/cve-2019-2618/blob/master/cve-2019-2618.py; reference: url, github.com/ptresearch/AttackDetection; classtype:web-application-attack; sid: 30000008; rev: 1;)
drop tcp any any -> any $HTTP_PORTS (msg: "ThinkPHP5 5.0.22/5.1.29 RCE"; flow:to_server; content:"GET"; http_method; content:"="; http_uri; pcre:"/(?i)(think%5CLoader)|(file_put_contents)|(Composer%5CAutoload%5CComposerStaticInit289837ff5d5ea8a00f5cc97a07c04561)|(think%5CError)|(think%5CContainer)|(think%5CApp)|(think%5CEnv)|(think%5CConfig)|(think%5CHook)|(think%5CFacade)|(think%5Cfacade%5CEnv)|(env)|(think%5CDb)|(think%5CLang)|(think%5CRequest)|(think%5CLog)|(think%5Clog%5Cdriver%5CFile)|(think%5Cfacade%5CRoute)|(route)|(think%5CRoute)|(think%5Croute%5CRule)|(think%5Croute%5CRuleGroup)|(think%5Croute%5CDomain)|(think%5Croute%5CRuleItem)|(think%5Croute%5CRuleName)|(think%5Croute%5CDispatch)|(think%5Croute%5Cdispatch%5CUrl)|(think%5Croute%5Cdispatch%5CModule)|(think%5CMiddleware)|(think%5CCookie)|(think%5CView)|(think%5Cview%5Cdriver%5CThink)|(think%5CTemplate)|(think%5Ctemplate%5Cdriver%5CFile)|(think%5CSession)|(think%5CDebug)|(think%5CCache)|(think%5Ccache%5CDriver)|(think%5Ccache%5Cdriver%5CFile)|(think%5CRoute)|(think%5CConfig)|(think%5CError)|(think%5CApp)|(think%5CRequest)|(think%5CHook)|(think%5CEnv)|(think%5CLang)|(think%5CLog)|(hink%5CLoader)(?i)/i"; classtype:web-application-attack; sid:30000060;rev:1;)
drop tcp any any -> any any (msg:"antsword php webshell detected"; content:"%40ini_set(%22display_errors%22%2C%20%220%22"; http_client_body; classtype:trojan-activity; sid:30000144; rev:1;)
drop tcp any any -> any $HTTP_PORTS (msg:"tongda oa file upload"; flow: established,to_server; content: "POST"; http_method; content: "/ispirit/im/upload.php"; http_uri; content: "multipart/form-data"; http_header; content: "name=\"P\""; http_client_body; classtype:web-application-attack; sid: 30000146; rev:1;)
drop tcp any any -> any $HTTP_PORTS (msg:"ThinkPHP5 5.0.23 RCE"; flow: established, to_server; flowbits: set, 30000023; content: "POST"; http_method; content: "s=captcha"; nocase; http_uri; content: "_method=__construct"; nocase; http_client_body; content: "filter[]=system"; nocase; http_client_body; content: "method=get"; nocase; http_client_body; content: "server[REQUEST_METHOD]="; nocase; http_client_body; reference:url, github.com/top-think/framework/commit/4a4b5e64fa4c46f851b4004005bff5f3196de003; classtype:web-application-attack; sid:30000023; rev: 1; )
drop tcp any $HTTP_PORTS -> any any (msg:"ThinkPHP5 5.0.23 RCE resp"; flow: established, to_client; flowbits: isset, 30000023; content: "200"; http_stat_code; reference:url, github.com/top-think/framework/commit/4a4b5e64fa4c46f851b4004005bff5f3196de003; classtype:web-application-attack; sid:30000024; rev: 1; )
drop tcp any any -> any $HTTP_PORTS (msg:"weblogic ssrf"; flow:to_server; content:"uddiexplorer/SearchPublicRegistries.jsp"; http_uri; nocase; content:"operator"; pcre:"/((\\d{1,3}\\.){3}\\d{1,3})|(([A-Za-z0-9]{1,}\\.){1,}[a-zA-Z0-9]{2,})/i"; classtype:network-scan; sid:30000152; rev:1;)
drop tcp any any -> any $HTTP_PORTS (msg:"weblogic ssrf uddiexplorer"; flow:to_server; content:"uddiexplorer"; http_uri; flowbits:set,weblogicssrf; flowbits:noalert; classtype:network-scan; sid:30000153; rev:1;)
drop tcp any $HTTP_PORTS -> any any (msg:"weblogic ssrf resp"; flow:to_client; content:"An error has occurred"; nocase; flowbits:isset,weblogicssrf; classtype:network-scan; sid:30000154; rev:1;)
drop tcp any any -> any $HTTP_PORTS (msg:"weblogic RCE CVE-2020-2551"; flow:established,to_server; content:"GIOP"; content:"NameService"; distance:0; content:"weblogic.iiop.ProxyDesc"; content:"java.rmi.remote"; nocase; pcre:"/ldap:\/\/(?:[0-9]{1,3}\.){3}[0-9]{1,3}/i"; classtype:web-application-attack; reference:cve,2020-2551; sid:30000155; rev:1;)
drop tcp any any -> any $HTTP_PORTS (msg:"GIOP detected"; flow:to_server; flowbits:set,weblogic_0day_20200326_1; flowbits:noalert; content:"GIOP"; classtype:web-application-attack; sid:7; rev:1;)
drop tcp any $HTTP_PORTS -> any any (msg:"weblogic rce 0day 20200326 resp"; flow:to_client; flowbits:isset,weblogic_0day_20200326_1; content:"weblogic.cosnaming.NameService"; nocase; content:"naming/NamingContextAny"; nocase; distance:0; classtype:web-application-attack; sid:30000157; rev:1;)
drop tcp any any -> any $HTTP_PORTS (msg:"weblogic rce 0day 20200326"; flow:to_server;flowbits:isset,weblogic_0day_20200326_1; content:"naming/NamingContextAny"; nocase; pcre:"/ldap|rmi/"; classtype:web-application-attack; sid:30000158; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"nexus3 OSS coreui_User RCE (CVE-2020-10204)"; flow:to_server; content:"POST"; http_method; content:"service/extdirect"; http_uri; nocase; content:"coreui_User";http_client_body; pcre:"/(java.lang.Runtime)|(java.lang.ProcessBuilder)/iP"; pcre:"/(invoke)|(getMethods)/iP"; classtype:web-application-attack; sid:30000159; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"nexus3 OSS EL RCE (CVE-2020-10204)"; flow:to_server; content:"POST"; http_method; content:"service/rest/beta/repositories/go/group"; http_uri; nocase; content:"Content-Type: application/json"; http_header; content:"memberNames"; http_client_body; content:"$"; http_client_body; distance:0; classtype:web-application-attack; sid:30000160; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"nexus3 OSS cleanup_CleanupPolicy RCE (CVE-2020-10199)"; flow:to_server; content:"POST"; http_method; content:"service/extdirect"; http_uri; nocase; content:"cleanup_CleanupPolicy"; http_client_body; pcre:"/(java.lang.Runtime)|(java.lang.ProcessBuilder)/iP"; pcre:"/(invoke)|(getMethods)/iP"; classtype:web-application-attack; sid:30000161; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NMAP -sS window 2048"; fragbits:!D; dsize:0; flags:S,12; ack:0; window:2048; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2000537; classtype:network-scan; sid:2000537; rev:8; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"NMAP -sO"; dsize:0; ip_proto:21; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2000536; classtype:network-scan; sid:2000536; rev:7; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NMAP -sA (1)"; fragbits:!D; dsize:0; flags:A,12; window:1024; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2000538; classtype:network-scan; sid:2000538; rev:8; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NMAP -sA (2)"; fragbits:!D; dsize:0; flags:A,12; window:3072; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2000540; classtype:network-scan; sid:2000540; rev:8; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NMAP -f -sF"; fragbits:!M; dsize:0; flags:F,12; ack:0; window:2048; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2000543; classtype:network-scan; sid:2000543; rev:7; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NMAP -f -sN"; fragbits:!M; dsize:0; flags:0,12; ack:0; window:2048; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2000544; classtype:network-scan; sid:2000544; rev:7; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NMAP -f -sX"; fragbits:!M; dsize:0; flags:FPU,12; ack:0; window:2048; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2000546; classtype:network-scan; sid:2000546; rev:7; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"PING NMAP"; dsize:0; itype:8; reference:arachnids,162; classtype:network-scan; sid:2100469; rev:4; metadata:created_at 2010_09_23, updated_at 2010_09_23;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"NMAP SQL Spider Scan"; flow:established,to_server; content:"GET"; http_method; content:" OR sqlspider"; http_uri; reference:url,nmap.org/nsedoc/scripts/sql-injection.html; classtype:network-scan; sid:2013778; rev:2; metadata:created_at 2011_10_19, updated_at 2011_10_19;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"nmap TCP"; ack:0; flags:A,12; flow:stateless; reference:arachnids,28; classtype:network-scan; sid:2100628; rev:8; metadata:created_at 2010_09_23, updated_at 2010_09_23;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"nmap XMAS"; flow:stateless; flags:FPU,12; reference:arachnids,30; classtype:network-scan; sid:2101228; rev:8; metadata:created_at 2010_09_23, updated_at 2010_09_23;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"nmap fingerprint attempt"; flags:SFPU; flow:stateless; reference:arachnids,05; classtype:network-scan; sid:2100629; rev:7; metadata:created_at 2010_09_23, updated_at 2010_09_23;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"Nmap Scripting Engine User-Agent Detected (Nmap Scripting Engine)"; flow:to_server,established; content:"Mozilla/5.0 (compatible|3b| Nmap Scripting Engine"; nocase; http_user_agent; depth:46; reference:url,doc.emergingthreats.net/2009358; classtype:network-scan; sid:2009358; rev:5; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NMAP -sS window 1024"; fragbits:!D; dsize:0; flags:S,12; ack:0; window:1024; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2009582; classtype:network-scan; sid:2009582; rev:3; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NMAP -sS window 3072"; fragbits:!D; dsize:0; flags:S,12; ack:0; window:3072; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2009583; classtype:network-scan; sid:2009583; rev:3; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NMAP -sS window 4096"; fragbits:!D; dsize:0; flags:S,12; ack:0; window:4096; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2009584; classtype:network-scan; sid:2009584; rev:2; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"NMAP SIP Version Detect OPTIONS Scan"; flow:established,to_server; content:"OPTIONS sip|3A|nm SIP/"; depth:19; classtype:network-scan; sid:2018317; rev:1; metadata:created_at 2014_03_25, updated_at 2014_03_25;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 5060:5061 (msg:"NMAP SIP Version Detection Script Activity"; content:"Via|3A| SIP/2.0/TCP nm"; content:"From|3A| <sip|3A|nm@nm"; within:150; fast_pattern; classtype:network-scan; sid:2018318; rev:1; metadata:created_at 2014_03_25, updated_at 2014_03_25;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"NMAP -f -sV"; fragbits:!M; dsize:0; flags:S,12; ack:0; window:2048; threshold: type both, track by_dst, count 1, seconds 60; reference:url,doc.emergingthreats.net/2000545; classtype:network-scan; sid:2000545; rev:8; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert udp $EXTERNAL_NET 10000: -> $HOME_NET 10000: (msg:"NMAP OS Detection Probe"; dsize:300; content:"CCCCCCCCCCCCCCCCCCCC"; fast_pattern:only; content:"CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC"; depth:255; content:"CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC"; within:45; classtype:network-scan; sid:2018489; rev:3; metadata:created_at 2014_05_20, updated_at 2014_05_20;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"Nmap Scripting Engine User-Agent Detected (Nmap NSE)"; flow:to_server,established; content:"Nmap NSE"; http_user_agent; reference:url,doc.emergingthreats.net/2009359; classtype:network-scan; sid:2009359; rev:4; metadata:created_at 2010_07_30, updated_at 2010_07_30;)
alert tcp any any -> $HOME_NET any (msg:"Nmap NSE Heartbleed Request"; flow:established,to_server; content:"|18 03|"; depth:2; byte_test:1,<,4,2; content:"|01|"; offset:5; depth:1; byte_test:2,>,2,3; byte_test:2,>,200,6; content:"|40 00|Nmap ssl-heartbleed"; fast_pattern:2,19; classtype:network-scan; sid:2021023; rev:1; metadata:created_at 2015_04_28, updated_at 2015_04_28;)
alert tcp $HOME_NET any -> any any (msg:"Nmap NSE Heartbleed Response"; flow:established,from_server; content:"|18 03|"; depth:2; byte_test:1,<,4,2; byte_test:2,>,200,3; content:"|40 00|Nmap ssl-heartbleed"; fast_pattern:2,19; classtype:network-scan; sid:2021024; rev:1; metadata:created_at 2015_04_28, updated_at 2015_04_28;)
alert tcp $HOME_NET any -> any any (msg:"Possible Nmap User-Agent Observed"; flow:to_server,established; content:"|20|Nmap"; http_user_agent; fast_pattern; metadata: former_category SCAN; classtype:network-scan; sid:2024364; rev:3; metadata:affected_product Any, attack_target Client_and_Server, deployment Perimeter, signature_severity Audit, created_at 2017_06_08, performance_impact Low, updated_at 2017_06_13;)
drop tcp any any -> any $HTTP_PORTS (msg:"caidao php webshell detected"; content:"POST"; http_method; content:"array_map"; http_client_body; content:"$xx("; http_client_body; distance:10; base64_decode:bytes 41, offset 1, relative; base64_data; content:"ini_set("; content:"display_errors"; classtype:trojan-activity; sid:30000145; rev:1;)
drop tcp any any -> any $HTTP_PORTS (msg:"bingxie php shell detected"; flow:established,to_server; flowbits:set,bingxie_php_req; flowbits:noalert; content: "GET"; http_method; content:"php?pass"; http_uri; pcre:"/\=[0-9]{0,3}$/I"; classtype:trojan-activity; sid: 30000147; rev:1;)
drop tcp any $HTTP_PORTS -> any any (msg:"bingxie php shell detected resp"; flow:established,to_client; flowbits:set,bingxie_php_resp; flowbits:noalert; content:"Content-Length: 16"; http_header; pcre:"/[0-9a-zA-Z]{16}$/"; classtype:trojan-activity; sid:30000148; rev:1;)
drop tcp any $HTTP_PORTS -> any any (msg:"bingxie php shell detected resp"; flow:established,to_client; flowbits:isset,bingxie_php_req; flowbits:isset,bingxie_php_resp; content:"Content-Type: text/html"; http_header; pcre:"/\r\n\r\n[a-zA-Z\d\+\/]{10,}/"; classtype:trojan-activity; sid:30000149; rev:1;)
drop tcp any any -> any $HTTP_PORTS (msg:"疑似冰蝎3.0 php 木马"; content:"php"; nocase; fast_pattern:only; http_uri; content:"Content-Length: 1112"; nocase; http_header; flowbits:set,bingxie3.0_php_1; flowbits:noalert; classtype:trojan-activity; sid:30000151; rev:1;)
drop tcp any $HTTP_PORTS -> any any (msg:"疑似冰蝎3.0 php 木马"; content:"Content-Length: 128"; http_header; nocase; flowbits:isset,bingxie3.0_php_1; classtype:trojan-activity; sid:2021050602; rev:1;)
drop tcp any any -> any $HTTP_PORTS (msg:"疑似冰蝎3 PHP HTTP Request"; flow:established,to_server; content:".php"; http_uri; pcre:"/[a-zA-Z0-9+/]{1000,}=/i"; flowbits:set,behinder3; flowbits:noalert; classtype:trojan-activity; sid:2021050603; rev:1; metadata:2020_08_28,by_shichangqi;)
drop tcp any $HTTP_PORTS -> any any (msg:"疑似冰蝎3PHP HTTP Response"; flow:established,to_client; content:"200"; http_stat_code; flowbits:isset,behinder3; pcre:"/[a-zA-Z0-9+/]{100,}=/i"; classtype:trojan-activity; sid:2021050604; rev:1; metadata:2020_08_28,by_co0ontty;)
drop tcp any any -> any $HTTP_PORTS (msg:"spring cloud path through cve-2019-3799"; flow:to_server,established; content:"GET"; http_method; content:"/foo/default/master/..%252F"; http_raw_uri; reference:cve,2014-0099; classtype:web-application-attack; sid:2021050605; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"用友 nc 6.5 反序列化命令执行 QTVA-2020-1523171"; flow:to_server,established; content:"POST"; http_method; content:"servlet"; nocase; http_uri; content:"DeleteServlet"; nocase; http_uri; pcre:"/(ProcessBuilder|getRuntime|denyMethodExecution|FileOutputStream|memberAccess)/iP"; classtype:web-application-attack; sid:10000369; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"用友 nc 6.5 xxe QTVA-2020-1513598"; flow:to_server,established; content:"POST"; http_method; content:"servlet"; http_uri; nocase; content:"XChangeServlet"; nocase; http_uri; content:"DOCTYPE"; nocase; http_client_body; content:"ENTITY"; nocase; http_client_body; content:"%dtd\;"; nocase; http_client_body; content:"%send\;"; nocase; http_client_body; classtype:web-application-attack; sid:10000368; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"用友 nc 6.5 SQL 注入 QTVA-2020-1516883"; flow:to_server,established; content:"/uapws/service/"; http_uri; content:"soapenv"; http_client_body; content:"<imet:string>"; http_client_body; pcre:"/<imet:string>.+\'.+\-\-<\/imet:string>/iP"; classtype:web-application-attack; sid:10000367; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"锐捷EWEB网关系统任意命令执行漏洞 QTVA-2020-1536827"; flow:to_server; content:"/guest_auth/guestIsUp.php"; nocase; http_uri; content:"mac"; http_client_body; content:"ip"; http_client_body; pcre:"/.{2,}\ .{2,}/iP"; classtype:web-application-attack; sid:10000371; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"锐捷EWEB网关系统任意命令执行漏洞"; flow:to_server; content:"/guest_auth/smsCheck.php"; nocase; http_uri; content:"type="; http_client_body; pcre:"/\&.{0,}gip.{0,}\=(\d{1,3}\.){3,3}(\d{1,3}).+(%26){2}.{3,}\&/iP"; classtype:web-application-attack; sid:10000370; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"fastjson 探测"; flow:to_server; content:"java.net"; http_client_body; content:"val"; http_client_body; pcre:"/{\".+\":{\"@type\":\"(java\.net\.Inet6Address|java\.net\.Inet4Address|java\.net\.InetAddress)\"\,\"val\"\:\"[\w.]+\..+"\}\}/iP"; classtype:network-scan; sid:10000456; rev:1; metadata:2020_11_03,by_co0ontty;)
alert tcp any any -> any $HTTP_PORTS (msg:"检测到 DNSLOG CEYE"; content:"ceye.io"; http_client_body; pcre:"/[a-zA-Z0-9]{5,10}\.ceye\.io/iP"; classtype:shellcode-detect; sid:2021050606; rev:1; metadata:2020_11_04,by_co0ontty;)
alert tcp any any -> any $HTTP_PORTS (msg:"检测到 DNSLOG CEYE"; content:"ceye.io"; http_uri; pcre:"/[a-zA-Z0-9]{5,10}\.ceye\.io/iI"; classtype:shellcode-detect; sid:10000457; rev:1; metadata:2020_11_04,by_co0ontty;)
alert tcp any any -> any $HTTP_PORTS (msg:"检测到 DNSLOG CEYE"; content:"ceye.io"; http_header; pcre:"/[a-zA-Z0-9]{5,10}\.ceye\.io/iH"; classtype:shellcode-detect; sid:10000458; rev:1; metadata:2020_11_04,by_co0ontty;)
alert tcp any any -> any $HTTP_PORTS (msg:"检测到 DNSLOG 疑似云悉扫描"; content:"yunsee.org"; fast_pattern; pcre:"/[a-zA-Z0-9]{1,}\.[a-zA-Z0-9]{1,}\.yunsee\.org/i"; classtype:shellcode-detect; sid:10000460; rev:1; metadata:2020_11_04,by_co0ontty;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 wget url"; content:"wget"; http_uri; nocase; classtype:shellcode-detect; sid:60001; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 curl url"; content:"curl"; http_uri; nocase; classtype:shellcode-detect; sid:60002; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 chmod url"; content:"chmod"; http_uri; nocase; classtype:shellcode-detect; sid:60003; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 whoami url"; content:"whoami"; http_uri; nocase; classtype:shellcode-detect; sid:60004; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 icmp url"; content:"ping"; http_uri; nocase; classtype:shellcode-detect; sid:60005; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 wget body"; content:"wget"; http_client_body; nocase; classtype:shellcode-detect; sid:60007; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 curl body"; content:"curl"; http_client_body; nocase; classtype:shellcode-detect; sid:60008; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 chmod body"; content:"chmod"; http_client_body; nocase; classtype:shellcode-detect; sid:60009; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 whoami body"; content:"whoami"; http_client_body; nocase; classtype:shellcode-detect; sid:60010; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 icmp body"; content:"ping"; http_client_body; nocase; classtype:shellcode-detect; sid:60011; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 wget header"; content:"wget"; http_header; nocase; classtype:shellcode-detect; sid:60013; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 curl header"; content:"curl"; http_header; content:!"curl"; http_user_agent; nocase; classtype:shellcode-detect; sid:60014; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 chmod header"; content:"chmod"; http_header; nocase; classtype:shellcode-detect; sid:60015; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 whoami header"; content:"whoami"; http_header; nocase; classtype:shellcode-detect; sid:60016; rev:1;)
drop tcp any any -> any $HTTP_PORTS (msg:"WebLogic wls-wsat RCE (CVE-2017-10271,CVE-2017-10352,CVE-2017-3506)"; flow: established, to_server; content:"POST";http_method;content: "wls-wsat"; nocase; http_uri; pcre: "/(sun\.misc\.BASE64Decoder)|(weblogic\.utils\.Hex)|(java\.lang\.ProcessBuilder)|(java\.lang\.Runtime)|(java\.lang\.String)|(java\.io\.PrintWriter)|(java\.beans\.XMLDecoder)|(defineClass)/P"; reference: cve, 2017-10271;reference: cve, 2017-3506;reference: cve, 2017-10352;classtype:web-application-attack; sid: 10000001; rev: 1; )
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 icmp header"; content:"ping"; http_header; nocase; classtype:shellcode-detect; sid:60017; rev:1;)
alert tcp $EXTERNAL_NET any -> any $HTTP_PORTS (msg:"0day_捕获器 路由器 HNAP"; content:"HNAP1"; http_uri; nocase; classtype:shellcode-detect; sid:60018; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"INDICATOR-SCAN 检测到 xray webscan basic-crawler 扫描"; flow:to_server; content:"GET"; http_method; content:"config"; http_uri; content:"Go-http-client"; http_header; nocase; flowbits:set,xray-config; flowbits:noalert; classtype:network-scan; sid:63823479; rev:1; metadata:2020_12_02,by_co0ontty;)
alert tcp any any -> any $HTTP_PORTS (msg:"INDICATOR-SCAN 检测到 xray webscan basic-crawler 扫描"; flow:to_server; content:"GET"; http_method; content:"external"; http_uri; content:"Go-http-client"; http_header; nocase; flowbits:isset,xray-config; classtype:network-scan; sid:63823480; rev:1; metadata:2020_12_02,by_co0ontty;)
alert tcp any any -> any $HTTP_PORTS (msg:"INDICATOR-SCAN xray webscan 扫描 - 字典关键字"; flow:to_server; content:"GET"; http_method; fast_pattern; content:!"Accept-Language"; nocase; http_header; pcre:"/egvwtbgemv|webtools/control/xmlrpc|.DS_Store|upload.jsp|config.json|wwkwgoysxk|yiuoususxz|upload.aspx|.config.php.swp|etc/passwd|htdocs.tar.gz|jmx-console/HtmlAdaptor|gruulgbcwr|gxdkeaeaea|wkagwmsgxw|ufdbhahrkn|help|files|kgghnvgugi|phpinfo.php|src.tar.gz|upload.html|info.php|utcmprgfew|upload.do|i.php|memadmin/index.php|upfile.php|tz.php|webtools/control/xmlrpc|nohup.out|ghxmlayorp|plus/weixin.php?signature|index.php~|plus/ajax_officebuilding.php?act=key&key=|.svn/entries|config.php~|dhtrfovtmt|index.php?m=&c=AjaxPersonal&a=company_focus|index.php.bak|debug.txt|fileserver/arfdku.txt|config.php.bak|lqsnefxdwt|jenkins/script|rlcutadrcc|jars|swhhzdbglu|upload.php|.index.php.swp|upload.asp|.config.inc.php.swp|code.tar.gz|config/.config.php.swp|mwmyyggwel|ukgyliyrzl|db.php.bak|data.txt|config.inc.php.bak|vlmzngrvgm|servnmrttv|upfile.jsp|php.php|glafxmipek|test.php|pma|.database.php.swp|%C0%AE%C0%AE|tools.tar.gz|xmszkcnrlk|/plug/oem/AspCms_OEMFun.asp|shell.php|upload.sh|rest/tinymce/1/macro/preview|cfocghwavf|.ssh/id_rsa.pub|shell.asp|login.do|setup.sh|proxy.pac|shell.aspx|login.jsp|backup.sh|v1/agent/self|ocwqevtyzb|id_rsa.pub|login.asp|ksyqvdavnp|.bashrc|/v1/agent/self|.ssh/authorized_keys|webshell.jsp|login|kyoudkmwll|_users/org.couchdb.user:nckqlucrthfxkxhgrgidmcosjievcpcl|id_dsa|include/downmix.inc.php|id_rsa|.db.php.swp|webroot.zip|debug.php|solr|.htaccess.bak|vpn/../vpns/cfg/smb.conf|yqgpugxupz|menu/stapp|admin.jsp|db.inc|admin.do|/iI"; flowbits:set,xray_dict; flowbits:noalert; classtype:network-scan; sid:10000498; rev:1; metadata:2020_12_02,by_co0ontty;)
alert tcp any any -> any $HTTP_PORTS (msg:"INDICATOR-SCAN xray webscan 扫描 - 字典关键字"; flow:from_server; content:l"200"; http_stat_code; flowbits:isset,xray_dict; flowbits:set,xray_dict_resp; flowbits:noalert; classtype:network-scan; sid:10000499; rev:1; metadata:2020_12_02,by_co0ontty;)
alert tcp any any -> any $HTTP_PORTS (msg:"INDICATOR-SCAN xray webscan 扫描 - 字典关键字"; flow:to_server; content:"GET"; http_method; fast_pattern; content:!"Accept-Language"; nocase; http_header; pcre:"/egvwtbgemv|webtools/control/xmlrpc|.DS_Store|upload.jsp|config.json|wwkwgoysxk|yiuoususxz|upload.aspx|.config.php.swp|etc/passwd|htdocs.tar.gz|jmx-console/HtmlAdaptor|gruulgbcwr|gxdkeaeaea|wkagwmsgxw|ufdbhahrkn|help|files|kgghnvgugi|phpinfo.php|src.tar.gz|upload.html|info.php|utcmprgfew|upload.do|i.php|memadmin/index.php|upfile.php|tz.php|webtools/control/xmlrpc|nohup.out|ghxmlayorp|plus/weixin.php?signature|index.php~|plus/ajax_officebuilding.php?act=key&key=|.svn/entries|config.php~|dhtrfovtmt|index.php?m=&c=AjaxPersonal&a=company_focus|index.php.bak|debug.txt|fileserver/arfdku.txt|config.php.bak|lqsnefxdwt|jenkins/script|rlcutadrcc|jars|swhhzdbglu|upload.php|.index.php.swp|upload.asp|.config.inc.php.swp|code.tar.gz|config/.config.php.swp|mwmyyggwel|ukgyliyrzl|db.php.bak|data.txt|config.inc.php.bak|vlmzngrvgm|servnmrttv|upfile.jsp|php.php|glafxmipek|test.php|pma|.database.php.swp|%C0%AE%C0%AE|tools.tar.gz|xmszkcnrlk|/plug/oem/AspCms_OEMFun.asp|shell.php|upload.sh|rest/tinymce/1/macro/preview|cfocghwavf|.ssh/id_rsa.pub|shell.asp|login.do|setup.sh|proxy.pac|shell.aspx|login.jsp|backup.sh|v1/agent/self|ocwqevtyzb|id_rsa.pub|login.asp|ksyqvdavnp|.bashrc|/v1/agent/self|.ssh/authorized_keys|webshell.jsp|login|kyoudkmwll|_users/org.couchdb.user:nckqlucrthfxkxhgrgidmcosjievcpcl|id_dsa|include/downmix.inc.php|id_rsa|.db.php.swp|webroot.zip|debug.php|solr|.htaccess.bak|vpn/../vpns/cfg/smb.conf|yqgpugxupz|menu/stapp|admin.jsp|db.inc|admin.do|/iI"; flowbits:isset,xray_dict_resp; flowbits:noalert; flowbits:set,xray_dict_2; classtype:network-scan; sid:10000500; rev:1; metadata:2020_12_02,by_co0ontty;)
alert tcp any any -> any $HTTP_PORTS (msg:"INDICATOR-SCAN xray webscan 扫描 - 字典关键字"; flow:from_server; content:!"200"; http_stat_code; flowbits:isset,xray_dict_2; flowbits:noalert; flowbits:set,xray_dict_resp_2; classtype:network-scan; sid:10000501; rev:1; metadata:2020_12_02,by_co0ontty;)
alert tcp any any -> any $HTTP_PORTS (msg:"INDICATOR-SCAN xray webscan 扫描 - 字典关键字"; flow:to_server; content:"GET"; http_method; fast_pattern; content:!"Accept-Language"; nocase; http_header; pcre:"/egvwtbgemv|webtools/control/xmlrpc|.DS_Store|upload.jsp|config.json|wwkwgoysxk|yiuoususxz|upload.aspx|.config.php.swp|etc/passwd|htdocs.tar.gz|jmx-console/HtmlAdaptor|gruulgbcwr|gxdkeaeaea|wkagwmsgxw|ufdbhahrkn|help|files|kgghnvgugi|phpinfo.php|src.tar.gz|upload.html|info.php|utcmprgfew|upload.do|i.php|memadmin/index.php|upfile.php|tz.php|webtools/control/xmlrpc|nohup.out|ghxmlayorp|plus/weixin.php?signature|index.php~|plus/ajax_officebuilding.php?act=key&key=|.svn/entries|config.php~|dhtrfovtmt|index.php?m=&c=AjaxPersonal&a=company_focus|index.php.bak|debug.txt|fileserver/arfdku.txt|config.php.bak|lqsnefxdwt|jenkins/script|rlcutadrcc|jars|swhhzdbglu|upload.php|.index.php.swp|upload.asp|.config.inc.php.swp|code.tar.gz|config/.config.php.swp|mwmyyggwel|ukgyliyrzl|db.php.bak|data.txt|config.inc.php.bak|vlmzngrvgm|servnmrttv|upfile.jsp|php.php|glafxmipek|test.php|pma|.database.php.swp|%C0%AE%C0%AE|tools.tar.gz|xmszkcnrlk|/plug/oem/AspCms_OEMFun.asp|shell.php|upload.sh|rest/tinymce/1/macro/preview|cfocghwavf|.ssh/id_rsa.pub|shell.asp|login.do|setup.sh|proxy.pac|shell.aspx|login.jsp|backup.sh|v1/agent/self|ocwqevtyzb|id_rsa.pub|login.asp|ksyqvdavnp|.bashrc|/v1/agent/self|.ssh/authorized_keys|webshell.jsp|login|kyoudkmwll|_users/org.couchdb.user:nckqlucrthfxkxhgrgidmcosjievcpcl|id_dsa|include/downmix.inc.php|id_rsa|.db.php.swp|webroot.zip|debug.php|solr|.htaccess.bak|vpn/../vpns/cfg/smb.conf|yqgpugxupz|menu/stapp|admin.jsp|db.inc|admin.do|/iI"; detection_filter:track by_src,count 150, seconds 3; flowbits:isset,xray_dict_resp_2; classtype:network-scan; sid:10000502; rev:1; metadata:2020_12_02,by_co0ontty;)
alert tcp any any -> any $HTTP_PORTS (msg:"奇安信云扫 jiance.qianxin.com"; flow:to_server; content:"jiance.qianxin.com"; classtype:network-scan; sid:313107; rev:1; metadata:2020_11_03,by_co0ontty;)
alert tcp any any -> any $HTTP_PORTS (msg:"SaltStack CVE-2020-16846 命令注入漏洞 CVE-2020-25592 验证绕过漏洞"; flow:to_server; content:"POST"; http_method; content:"run"; http_uri; content:"application/x-www-form-urlencoded"; http_header; content:"client=ssh"; http_client_body; content:"ssh_priv"; http_client_body; fast_pattern; pcre:"/((%26|&).+(%26|&)(%26|&))/iP"; classtype:web-application-attack; sid:10000461; rev:1; metadata:2020_11_05,by_co0ontty;)
alert tcp any any -> any 22 (msg:"SSH 防暴力破解" ; flow:established,to_server; content:"SSH"; nocase; offset:0; depth:4; detection_filter:track by_src, count 10, seconds 1; classtype:attempted-admin; sid:63019130; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"phpunit RCE CVE-2017-9841"; flow:to_server,established; content:"POST"; http_method; content:"/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php";http_uri; nocase; metadata:service phpunit; classtype:web-application-attack; reference:cve,2017-9841; sid:313186; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"命令执行 images.php"; flow:to_server; content:"POST"; http_method; content:"images.php"; content:"&code="; http_client_body; pcre:"/code=[a-zA-Z0-9+\/]{5,}(%3D%3D|\=\=)/iP"; classtype:web-application-attack; sid:313101; rev:1; metadata:2020_09_30,by_co0ontty_honeypot;)
alert tcp any any -> any any (msg:"Mozi 僵尸网络"; flow:to_server; content:"Mozi."; nocase; sid:2021042801; classtype:trojan-activity;)
alert tcp any any -> any any (msg:"solr 探测"; flow:to_server; content:"/solr/"; nocase; sid:2021042802; classtype:network-scan;)
alert tcp any any -> any any (msg:"solr 配置修改"; flow:to_server; content:"solr"; http_uri; content:"POST"; http_method; content:"update-queryresponsewriter"; htt_client_body; classtype:web-application-attack; sid:2021092901; rev:1; metadata:2020_09_30,by_co0ontty_honeypot;)
alert tcp any any -> any any (msg:"web 目录爆破 - 大量访问不存在目录"; flow:from_server; content:"404"; http_stat_code; threshold:type both,track by_dst,count 25,seconds 5; classtype:network-scan; sid:2021042804; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"POST 对外请求"; content:"POST"; http_method; sid:2021043001;)
alert tcp any any -> any any (msg:"POST body 存储"; content:"POST"; http_method; sid:2021043002;)
drop tcp any any -> any 1234 (msg:"Windows RDP暴力破解检测"; flow:established,to_server,no_stream; content:"|03 00|"; offset:0; depth:2; content:"|e0|"; offset:5; depth:1; threshold:type both,track by_src,count 20,seconds 10; classtype:attempted-admin; sid:190099; rev:1;)
alert tcp any any -> any any (msg:"wordpress 扫描"; flow:to_server; content:"wp-includes"; http_uri; classtype:network-scan; sid:2021050607; rev:1;)
alert tcp any any -> any any (msg:"ZmEu 扫描"; content:"ZmEu"; http_header; sid:2021050601; classtype:network-scan;)
alert tcp any any -> any any (msg:"Zmeu 扫描"; content:"w00tw00t.at.blackhats.romanian.anti-sec"; sid:2021050611; classtype:network-scan;)
alert tcp any any -> any any (msg:"SCO Openserver 5.0.7 命令执行漏洞"; flow:to_server; content:"/cgi-bin/printbook"; content:"outputform="; http_client_body; pcre:"/(%7c|%7C|\|)/Pi"reference:cve,2020-25494; classtype:shellcode-detect; sid:2021051201;)
alert tcp any any -> any any (msg:"Vmware vcenter未授权任意文件上传"; flow:to_server; http_method; content:"/ui/vropspluginui/rest/services/uploadova"; http_uri; classtype:web-application-attack; flowbits:set;cve-2021-21972; reference:cve,2021-21972; sid:2021051202;)
alert tcp any any -> any any (msg:"[成功事件]Vmware vcenter未授权任意文件上传"; flow:to_client; content:"vsphere-client"; content:"405"; http_stat_code; classtype:web-application-attack; flowbits:isset;cve-2021-21972; reference:cve,2021-21972; sid:2021051203;)
alert tcp any any -> any any (msg:"TerraMaster TOS远程命令执行漏洞"; flow:to_server; content:"include/makecvs.php"; http_uri; classtype:web-application-attack; sid:2021051204;)
alert tcp any any -> any any (msg:"weblogic 越权登录 cve-2020-14882"; flow:to_server; content:"%2e%2e%2fconsole.portal"; http_uri; reference:cve,2020-14882; classtype:web-application-attack; sid:2021051401; rev:1;)
alert tcp any any -> any any (msg:"zend framework3 反序列化 CVE-2021-3007"; flow:to_server; content:"/zend3/public/"; http_uri; pcre:"/hello=[a-zA-Z0-9\%]{300}/Pi"; classtype:web-application-attack; sid:2021051401;)
alert tcp any any -> any any (msg:"nrdh.php 命令执行漏洞"; content:"nrdh.php?cmd="; http_uri; sid:2021051701; classtype:shellcode-detect;)
drop tcp any any -> any any (msg:"CVE-2021-26084 confluence 命令执行漏洞"; content:"/pages/doenterpagevariables.action"; http_uri; pcre:"/(((\x7b|%7b))|(\x40|%40)(.+?)(ProcessBuilder|getRuntime|denyMethodExecution|FileOutputStream|memberAccess))/i"; classtype:web-application-attack; sid:2021092401;)
drop tcp any any -> any any (msg:"CVE-2021-26084 confluence 命令执行漏洞"; content:"/pages/createpage-entervariables.action"; http_uri; pcre:"/(((\x7b|%7b))|(\x40|%40)(.+?)(ProcessBuilder|getRuntime|denyMethodExecution|FileOutputStream|memberAccess))/i"; classtype:web-application-attack; sid:2021092402;)
alert tcp any any -> any any (msg:"weblogic 命令执行 CVE-2021-2109"; content:"%252e%252e%252fconsolejndi.portal"; pcre:"/(ProcessBuilder|getRuntime|denyMethodExecution|FileOutputStream|memberAccess)/iI"; classtype:web-application-attack; sid:2021052001;)
alert tcp any any -> any any (msg:"检测到 JAVA 命令执行 (java lang + many class)"; content:"java"; fast_pattern; nocase; content:"runtime"; nocase; pcre:"/java.lang((.+)(runtime.+getruntime|runtime.+exec|Process|ProcessBuilder)(.+))/i"; classtype:shellcode-detect; sid:10000432; rev:1;)
alert tcp any any -> any any (msg:"GIOP 远程代码执行 (cosnaming.NameService and corba)"; flow:to_server; flowbits:set,weblogic_0day_20200326_1; flowbits:noalert; content:"GIOP"; classtype:shellcode-detect; sid:312831; rev:1;)
alert tcp any any -> any any (msg:"GIOP 远程代码执行 (cosnaming.NameService and corba)"; flow:to_client; flowbits:isset,weblogic_0day_20200326_1; content:"weblogic.cosnaming.NameService"; nocase; content:"IDL:weblogic/corba/cos/naming"; nocase; distance:0; classtype:shellcode-detect; sid:312832; rev:1;)
alert tcp any any -> any any (msg:"GIOP 远程代码执行 (cosnaming.NameService and corba)"; flow:to_server;flowbits:isset,weblogic_0day_20200326_1; content:"IDL:weblogic/corba/cos/naming"; nocase; pcre:"/ldap|rmi/"; classtype:shellcode-detect; sid:312833; rev:1;)
alert tcp any any -> any any (msg:"检测到通过ognl表达式执行命令 ProcessBuilder"; flow:to_server; content:"ProcessBuilder"; pcre:"/(%23|%24|%25|#|$|%)({|%7B)(.+?)(ProcessBuilder|Runtime|denyMethodExecution|FileOutputStream|memberAccess)(.+?)(%7D|})/i"; classtype:web-application-attack; sid:10000550; rev:1; metadata:2020_12_11,co0ontty;)
alert tcp any any -> any any (msg:"检测到通过ognl表达式执行命令 Runtime"; flow:to_server; content:"Runtime"; pcre:"/(%23|%24|%25|#|$|%)({|%7B)(.+?)(ProcessBuilder|Runtime|denyMethodExecution|FileOutputStream|memberAccess)(.+?)(%7D|})/i"; classtype:web-application-attack; sid:10000551; rev:1; metadata:2020_12_11,co0ontty;)
alert tcp any any -> any any (msg:"检测到通过ognl表达式执行命令 denyMethodExecution"; flow:to_server; content:"denyMethodExecution"; pcre:"/(%23|%24|%25|#|$|%)({|%7B)(.+?)(ProcessBuilder|Runtime|denyMethodExecution|FileOutputStream|memberAccess)(.+?)(%7D|})/i"; classtype:web-application-attack; sid:10000552; rev:1; metadata:2020_12_11,co0ontty;)
alert tcp any any -> any any (msg:"DedeCMS命令执行检测"; content:"plus"; http_uri; content:"flink.php"; content:"select"; http_cliect_body; classtype:web-application-attack; sid:21101801;)
alert tcp any any -> any any (msg:"DedeCMS命令执行检测"; content:"plus/download.php"; http_uri; content:"arrs"; http_uri; classtype:web-application-attack; sid:21101802;)
alert tcp any any -> any any (msg:"检测到通过ognl表达式执行命令 memberAccess"; flow:to_server; content:"memberAccess"; pcre:"/(%23|%24|%25|#|$|%)({|%7B)(.+?)(ProcessBuilder|Runtime|denyMethodExecution|FileOutputStream|memberAccess)(.+?)(%7D|})/i"; classtype:web-application-attack; sid:10000553; rev:1; metadata:2020_12_11,co0ontty;)
alert tcp any any -> any any (msg:"检测到通过ognl表达式执行命令 FileOutputStream"; flow:to_server; content:"FileOutputStream"; pcre:"/(%23|%24|%25|#|$|%)({|%7B)(.+?)(ProcessBuilder|Runtime|denyMethodExecution|FileOutputStream|memberAccess)(.+?)(%7D|})/i"; classtype:web-application-attack; sid:10000554; rev:1; metadata:2020_12_11,co0ontty;)
